<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Chart 3 — Positive Drug Tests by Detection Method</title>
  <link rel="stylesheet" href="css/style.css">
</head>
<body>
  <!-- Top nav -->
  <div class="nav">
    <div class="container nav__bar">
      <a class="brand" href="index.html">Road<span>Safety</span></a>
      <nav class="nav__links">
        <a href="chart-1.html">Chart 1</a>
        <a href="chart-2.html">Chart 2</a>
        <a href="chart-3.html" class="active">Chart 3</a>
        <a href="chart-4.html">Chart 4</a>
        <a href="chart-5.html">Chart 5</a>
        <a href="chart-6.html">Chart 6</a>
      </nav>
    </div>
  </div>

  <!-- Hero -->
  <header class="hero chart-header chart3-hero">
    <div class="container centered">
      <h1 class="chart3-title">Positive drug tests by detection method</h1>
      <p class="chart3-intro">
        This chart shows which detection method — roadside screening, confirmatory testing,
        or laboratory analysis — records the highest number of positive drug tests in each year.
        Use the year filter to explore trends from 2008–2024.
      </p>

      <!-- KPI cards -->
      <div id="kpi3" class="kpi-grid kpi-grid-hero kpi-grid-3"></div>

      <div class="pager">
        <a class="btn btn--ghost" href="chart-2.html">← Previous</a>
        <a class="btn btn--brand" href="chart-4.html">Next →</a>
      </div>
    </div>
  </header>

  <!-- Main content -->
  <section>
    <div class="container chart-grid">
      <figure class="chart-figure">
        <figcaption class="kicker">
          Chart 3 · Positive drug tests by detection method (2008–2024)
        </figcaption>

        <!-- Year filter controls -->
        <div class="chart-controls-row">
          <span class="chart-label">Year:</span>

          <!-- Year chip + dropdown -->
          <div class="year-dropdown-wrapper">
            <button id="yearChip3" type="button" class="year-bubble year-chip-btn">
              All years (2008–2024)
            </button>

            <div id="yearDropdown3" class="year-dropdown hidden">
              <div class="year-dropdown-title">All years (2008–2024)</div>
              <div class="year-grid">
                <button class="year-option" data-year="2008">2008</button>
                <button class="year-option" data-year="2009">2009</button>
                <button class="year-option" data-year="2010">2010</button>
                <button class="year-option" data-year="2011">2011</button>
                <button class="year-option" data-year="2012">2012</button>
                <button class="year-option" data-year="2013">2013</button>
                <button class="year-option" data-year="2014">2014</button>
                <button class="year-option" data-year="2015">2015</button>
                <button class="year-option" data-year="2016">2016</button>
                <button class="year-option" data-year="2017">2017</button>
                <button class="year-option" data-year="2018">2018</button>
                <button class="year-option" data-year="2019">2019</button>
                <button class="year-option" data-year="2020">2020</button>
                <button class="year-option" data-year="2021">2021</button>
                <button class="year-option" data-year="2022">2022</button>
                <button class="year-option" data-year="2023">2023</button>
                <button class="year-option" data-year="2024">2024</button>
              </div>
            </div>
          </div>

          <!-- External reset button -->
          <button id="yearAllBtn3" type="button" class="btn btn--ghost btn--pill">
            All years
          </button>
        </div>

        <!-- Optional slider (keeps design consistent with Chart 2) -->
        <input
          type="range"
          id="yearSlider3"
          class="year-slider"
          min="2008"
          max="2024"
          step="1"
          value="2024"
        />

        <!-- Chart container -->
        <div id="chart3"></div>
      </figure>

      <aside class="notes">
  <h3>Notes &amp; Insights</h3>
  <ul class="list">
    <li>
      Indicator (Stage 1) tests usually have the biggest slice because they are used on the roadside
      for quick screening, so they capture most of the initial positives.
    </li>
    <li>
      Secondary confirmatory tests and lab or toxicology tests are smaller because they are only done
      on a subset of cases to double-check the first result or when a stronger legal outcome is needed.
    </li>
    <li>
      Years where the indicator slice grows suggest more roadside screening activity, while years with
      larger confirmatory or lab slices suggest a stronger focus on validating results and preparing
      evidence for court.
    </li>
    <li>
      By changing the year filter, you can see how police priorities shift between fast screening
      (indicator) and more detailed follow-up testing over time.
    </li>
  </ul>
</aside>

    </div>
  </section>

  <!-- Footer -->
  <footer>
    <div class="container footer">
      <div>© <span id="year3"></span> Road Safety</div>
      <div class="page-dots">
        <a href="chart-1.html">1</a> ·
        <a href="chart-2.html">2</a> ·
        <a href="chart-3.html">3</a> ·
        <a href="chart-4.html">4</a> ·
        <a href="chart-5.html">5</a>  .
        <a href="chart-6.html">Chart 6</a>
      </div>
    </div>
  </footer>

  <script>
    document.getElementById('year3').textContent = new Date().getFullYear();
  </script>

  <script src="https://d3js.org/d3.v7.min.js"></script>
  <script src="js/chart3.js"></script>

  <!-- Nav active script -->
  <script>
    const navLinks = document.querySelectorAll('.nav__links a');
    const current = window.location.pathname.split('/').pop() || 'index.html';

    navLinks.forEach(link => {
      const href = link.getAttribute('href');

      // highlight link that matches current page
      if (href === current) {
        link.classList.add('active');
      }

      // keep click behaviour consistent
      link.addEventListener('click', () => {
        navLinks.forEach(l => l.classList.remove('active'));
        link.classList.add('active');
      });
    });
  </script>
</body>
</html>
